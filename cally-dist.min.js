/*! cally 0.5.2 */
!function(a){var b=function(b,d){this.node=b,this.$node=a(b);var e={data:{}};if(a.getAntiForgeryToken instanceof Function){var f=a.getAntiForgeryToken();f&&a.extend(e.data,{__RequestVerificationToken:f.value})}switch(this.options=a.extend(e,d),this.loadErrorTemplate=a(c.loadingFailed).clone().show(),this.loadIndicatorTemplate=a(c.loadIndicator).clone().show(),this.modalDialog=a(c.modalDialog).clone().show().modal({show:!1,keyboard:!1,backdrop:!1}),this.mode=this.options.mode||this.$node.data("mode"),this.notifyStrategy=null,this.mode){case"html":this.notifyStrategy=this.htmlInjectionStrategy(this.options);break;case"html-replace":this.notifyStrategy=this.htmlReplaceNotifyStrategy(this.options);break;case"modal":this.notifyStrategy=this.modalNotifyStrategy(this.options);break;case"silent":this.notifyStrategy=this.silentNotifyStrategy(this.options);break;case"custom":this.notifyStrategy={loading:this.options.loading||function(){},done:this.options.done||function(){},retry:this.options.retry||function(){}};break;default:this.notifyStrategy=this.nonBlockingNotifyStrategy(this.options)}};b.prototype={constructor:b,onHtmlLoaded:function(a){d(a)},silentNotifyStrategy:function(){var a=function(){};return a.prototype={done:function(){},loading:function(){},retry:function(){}},new a},modalNotifyStrategy:function(){var b=this,c=function(){this.$node=a(b.node),this.options=b.options,this.modalDialog=b.modalDialog,this.loadErrorTemplate=b.loadErrorTemplate};return c.prototype={done:function(a,b){this.modalDialog.find(".modal-body").html(a),window.setTimeout(this.hideModal,2e3),options.done instanceof Function&&options.done(b)},loading:function(){this.modalDialog.find(".modal-body").html(this.$node.data("msg")),this.modalDialog.find(".modal-header").hide(),this.modalDialog.modal("show")},retry:function(){this.modalDialog.find(".modal-header").show(),this.modalDialog.find(".modal-body").html(this.loadErrorTemplate),this.modalDialog.modal("show")},hideModal:function(){b.modalDialog.modal("hide")}},new c},nonBlockingNotifyStrategy:function(b){var c=this,d=function(){this.$node=a(c.node),this.modalDialog=c.modalDialog,this.loadErrorTemplate=c.loadErrorTemplate};return d.prototype={done:function(a,c){toastr.clear(),toastr.success(a),b.done instanceof Function&&b.done(c)},loading:function(){var a=this.$node.data("msg")||"Loading...";toastr.info(a)},retry:function(){toastr.clear(),this.modalDialog.find(".modal-header").show(),this.modalDialog.find(".modal-body").html(this.loadErrorTemplate),this.modalDialog.modal("show")}},new d},htmlInjectionStrategy:function(){var b=this,c=function(){this.$node=a(b.node),this.$contents=a(b.options.contents||this.$node.data("contents")||this.$node.closest(".ajax-container").find(".contents")),this.loadErrorTemplate=b.loadErrorTemplate,this.loadIndicatorTemplate=b.loadIndicatorTemplate,this.onHtmlLoaded=b.onHtmlLoaded};return c.prototype={done:function(a,b){this.$contents.html(b.Html),this.onHtmlLoaded(this.$contents),options.done instanceof Function&&options.done(b)},loading:function(){this.$contents.html(this.loadIndicatorTemplate)},retry:function(){this.$contents.html(this.loadErrorTemplate)}},new c},htmlReplaceNotifyStrategy:function(){var b=this,c=function(){this.$node=a(b.node),this.$contents=a(this.$node.closest(".ajax-container")||this.$node.parent),this.loadErrorTemplate=b.loadErrorTemplate,this.loadIndicatorTemplate=b.loadIndicatorTemplate,this.onHtmlLoaded=b.onHtmlLoaded};return c.prototype={done:function(a,b){this.$contents.html(b.Html),this.onHtmlLoaded(this.$contents),options.done instanceof Function&&options.done(b)},loading:function(){this.$contents.html(this.loadIndicatorTemplate)},retry:function(){this.$contents.html(this.loadErrorTemplate)}},new c},callOnEvent:function(){function b(){function d(){h.retry(),g.find(".load-retry").one("click",function(){b()})}function i(){a(f).attr("disabled","disabled")}function j(){a(f).removeAttr("disabled")}if(!(c.shouldProceed instanceof Function&&c.shouldProceed()===!1)){var k=""===a(f).data("once"),l=""===a(f).data("loaded");if(!k||!l){var m={},n=a(f).closest("form,.ajax-container").find("select, textarea, input");a.each(n.serializeArray(),function(b,c){m.hasOwnProperty(c.name)?(m[c.name]=a.makeArray(m[c.name]),m[c.name].push(c.value)):m[c.name]=c.value});var o=a.extend(e,m);c.getPostData instanceof Function&&(o=a.extend(e,c.getPostData())),i(),h.loading();var p=a.ajax({type:"POST",url:a(f).data("url")||c.url,data:o,traditional:!0});p.fail(function(){d()}),p.done(function(b){a(f).attr("data-loaded","");var c=a(f).data("done-msg")||"Done.";h.done(c,b)}),p.always(function(){window.setTimeout(j,1e3)})}}}var c=this.options,d=this.options.event||this.$node.data("event")||"click",e=this.options.data,f=this.node,g=this.loadErrorTemplate,h=this.notifyStrategy;"ready"===d?b():a(this.node).on(d,function(){b()})}},a.fn.extend({callOnEvent:function(a){return this.each(function(){new b(this,a).callOnEvent()})},callOnClick:function(a){return this.each(function(){new b(this,a).callOnEvent()})},callOnLoad:function(c){return a.extend(c,{event:"ready"}),this.each(function(){new b(this,c).callOnLoad()})}});var c={modalDialog:['<div style="display:none" class="modal">','   <div class="modal-dialog">','      <div class="modal-content">','         <div class="modal-header" style="display:none">','            <span class="header-content">Error</span>','            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>',"         </div>",'         <div class="modal-body">Working...</div>',"      </div>","   </div>","</div>"].join(""),loadIndicator:['<div style="display:none" class="load-indicator load-indicator-big"></div>'].join(""),loadingFailed:['<div style="display:none" class="alert alert-danger load-error">',"   <span>Loading failed&nbsp;</span>",'   <button class="btn btn-danger load-retry">Retry</button>',"</div>"].join("")},d=function(a){a.find(".call-on-load").callOnLoad(),a.find(".call-on-click").callOnClick()};a(document).ready(function(){d(a(document))})}(jQuery);;(function(e){e.getAntiForgeryToken=function(e,t){e=e&&typeof e==typeof window?e:window,t=t&&typeof t=="string"?"_"+t.toString():"";var n="__RequestVerificationToken"+t,r=e.document.getElementsByTagName("input");for(var i=0;i<r.length;i++){var s=r[i];if(s.type==="hidden"&&s.name===n)return{name:n,value:s.value}}},e.appendAntiForgeryToken=function(t,n){return t&&typeof t!="string"&&(t=e.param(t)),n=n?n:e.getAntiForgeryToken(),t=t?t+"&":"",n?t+encodeURIComponent(n.name)+"="+encodeURIComponent(n.value):t},e.postAntiForgery=function(t,n,r,i){return e.post(t,e.appendAntiForgeryToken(n),r,i)},e.ajaxAntiForgery=function(t){var n=t.token?t.token:e.getAntiForgeryToken(t.tokenWindow,t.appPath);return t.data=e.appendAntiForgeryToken(t.data,n),e.ajax(t)}})(jQuery);